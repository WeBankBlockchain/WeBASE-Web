(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"/0Jq":function(e,t,a){},"8oDB":function(e,t,a){"use strict";var s=a("Cb9/");a.n(s).a},"Cb9/":function(e,t,a){},YUMh:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"rivate-key-management-wrapper"},[a("v-contentHead",{attrs:{headTitle:"用户查看"}}),e._v(" "),a("div",{staticClass:"module-wrapper"},[a("div",{staticClass:"search-part"},[a("div",{staticClass:"search-part-left"},[a("el-button",{staticClass:"search-part-left-btn",attrs:{type:"primary",disabled:e.disabled},on:{click:function(t){return e.$store.dispatch("switch_creat_user_dialog")}}},[e._v("新增用户")])],1),e._v(" "),a("div",{staticClass:"search-part-right"},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入用户名或公钥地址"},model:{value:e.userName,callback:function(t){e.userName=t},expression:"userName"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.search},slot:"append"})],1)],1)]),e._v(" "),a("div",{staticClass:"search-table"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.rivateKeyList,"tooltip-effect":"light"}},e._l(e.rivateKeyHead,function(t){return a("el-table-column",{key:t.enName,attrs:{label:t.name,"show-overflow-tooltip":"",width:e.tdWidth[t.enName]||"",align:"center"},scopedSlots:e._u([{key:"default",fn:function(s){return["operate"!=t.enName?["userStatus"===t.enName?a("span",{style:{color:e.statusColor(s.row[t.enName])}},[e._v(e._s(e.userStatus(s.row[t.enName])))]):"address"===t.enName?a("span",[a("i",{staticClass:"wbs-icon-copy font-12 copy-public-key",attrs:{title:"复制公钥"},on:{click:function(a){return e.copyPubilcKey(s.row[t.enName])}}}),e._v("\n                                "+e._s(s.row[t.enName])+"\n                            ")]):"userId"===t.enName?a("span",[a("el-tooltip",{attrs:{content:1==s.row.hasPk?"私钥":"公钥",placement:"top"}},[a("i",{staticClass:"wbs-icon-key-b font-12",style:{color:1==s.row.hasPk?"#FFC31F":"#4F9DFF"}})]),e._v("\n                                "+e._s(s.row[t.enName])+"\n                            ")],1):a("span",[e._v(e._s(s.row[t.enName]))])]:[a("el-button",{attrs:{disabled:e.disabled,type:"text",size:"small"},on:{click:function(t){return e.modifyDescription(s.row)}}},[e._v("修改")])]]}}],null,!0)})}),1),e._v(" "),a("el-pagination",{staticClass:"page",attrs:{"current-page":e.currentPage,"page-sizes":[10,20,30,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)]),e._v(" "),e.$store.state.creatUserVisible?a("el-dialog",{staticClass:"dialog-wrapper",attrs:{visible:e.$store.state.creatUserVisible,title:"新建用户",width:"621px","append-to-body":!0,center:""},on:{"update:visible":function(t){return e.$set(e.$store.state,"creatUserVisible",t)}}},[a("v-creatUser",{ref:"creatUser",on:{creatUserClose:e.creatUserClose,bindUserClose:e.bindUserClose}})],1):e._e()],1)};s._withStripped=!0;var r=a("YEIV"),n=a.n(r),i=a("qse9"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"key-dialog"},[a("div",{staticClass:"text-center"},[a("span",{staticClass:"wbs-icon-radio radio-key riv-key",style:{color:e.rivKey?"#4b8fe5":""},on:{click:function(t){return e.changeKey("RIV")}}},[a("span",{staticClass:"base-span-key",style:{color:e.rivKey?"#2956a3":""}},[e._v("私钥用户")])]),e._v(" "),a("span",{staticClass:"wbs-icon-radio radio-key pub-key",style:{color:e.pubKey?"#4b8fe5":""},on:{click:function(t){return e.changeKey("PUB")}}},[a("span",{staticClass:"base-span-key",style:{color:e.pubKey?"#2956a3":""}},[e._v("公钥用户")])])]),e._v(" "),a("div",{staticClass:"divide-line"}),e._v(" "),a("el-form",{ref:"userForm",staticClass:"demo-ruleForm",attrs:{model:e.userForm,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{staticStyle:{width:"546px"},attrs:{label:"用户名称",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入用户名称",maxlength:"12"},model:{value:e.userForm.name,callback:function(t){e.$set(e.userForm,"name",t)},expression:"userForm.name"}})],1),e._v(" "),e.pubKey?a("el-form-item",{staticStyle:{width:"546px"},attrs:{label:"公钥信息",prop:"publicKey"}},[a("el-input",{attrs:{placeholder:"请输入公钥信息或公钥地址"},model:{value:e.userForm.publicKey,callback:function(t){e.$set(e.userForm,"publicKey",t)},expression:"userForm.publicKey"}})],1):e._e(),e._v(" "),a("el-form-item",{staticStyle:{width:"546px"},attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea",maxlength:"120",placeholder:"120个字符以内"},model:{value:e.userForm.explain,callback:function(t){e.$set(e.userForm,"explain",t)},expression:"userForm.explain"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer"},[a("el-button",{on:{click:e.modelClose}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.submit("userForm")}}},[e._v("确 定")])],1)],1)};o._withStripped=!0;var c=a("P2sY"),l=a.n(c),u=a("mHBk"),d=a("p5Bo"),m={name:"AddUser",data:function(){return{loading:!1,pubKey:!1,rivKey:!0,userForm:{name:"",explain:"",publicKey:""},rules:{name:[{required:!0,message:"请输入用户名称",trigger:"blur"},{min:1,max:12,message:"长度在 1 到 12 个字符",trigger:"blur"}],publicKey:[{required:!0,message:"请输入公钥信息",trigger:"blur"}]},networkId:localStorage.getItem("networkId")}},methods:{changeKey:function(e){switch(this.userForm={name:"",explain:"",publicKey:""},e){case"PUB":this.pubKey=!0,this.rivKey=!1;break;case"RIV":this.pubKey=!1,this.rivKey=!0}},modelClose:function(){this.userForm=l()({name:"",publicKey:"",explain:""}),this.pubKey=!0,this.loading=!1,this.$store.state.creatUserVisible=!1},submit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.$confirm("确认提交？",{center:!0}).then(function(){t.loading=!0,t.pubKey?t.getBindUser():t.addUser()}).catch(function(){t.modelClose()})})},addUser:function(){var e=this,t={networkId:this.networkId,userName:this.userForm.name,description:this.userForm.explain||""};Object(u.k)(t).then(function(t){e.loading=!1,0===t.data.code?(e.$emit("success"),e.$message({type:"success",message:"添加用户成功"}),e.$emit("creatUserClose"),e.modelClose()):(e.modelClose(),e.$message({type:"error",message:d.a.errCode[t.data.code].cn}))}).catch(function(t){e.$message({type:"error",message:"添加用户失败！"}),e.modelClose()})},getBindUser:function(){var e=this,t={userName:this.userForm.name,publicKey:this.userForm.publicKey,networkId:this.networkId,description:this.userForm.explain||""};Object(u.d)(t).then(function(t){e.loading=!1,0==t.data.code?(e.$message({type:"success",message:"添加用户成功"}),e.$emit("bindUserClose"),e.modelClose()):(e.modelClose(),e.$message({type:"error",message:d.a.errCode[t.data.code].cn}))}).catch(function(t){e.modelClose(),e.$message({type:"error",message:"添加用户失败！"})})}}},p=(a("8oDB"),a("KHd+")),h=Object(p.a)(m,o,[],!1,null,"3639a935",null);h.options.__file="src/views/rivateKeyManagement/components/creatUser.vue";var g=h.exports,f={name:"RivateKeyManagement",components:{"v-contentHead":i.a,"v-creatUser":g},data:function(){var e;return e={userName:this.$route.query.userName||"",loading:!1,currentPage:1,pageSize:10,total:0},n()(e,"loading",!1),n()(e,"disabled",!1),n()(e,"rivateKeyList",[]),n()(e,"rivateKeyHead",[{enName:"userName",name:"用户名称"},{enName:"userId",name:"用户ID"},{enName:"description",name:"用户描述"},{enName:"address",name:"用户公钥地址信息"},{enName:"userStatus",name:"用户状态"},{enName:"operate",name:"操作"}]),n()(e,"tdWidth",{publicKey:450}),e},mounted:function(){this.getUserInfoData(),"admin"===localStorage.getItem("root")?this.disabled=!1:this.disabled=!0},methods:{getUserInfoData:function(){var e=this;this.loading=!0;var t={networkId:localStorage.getItem("networkId"),pageNumber:this.currentPage,pageSize:this.pageSize},a={userParam:this.userName.replace(/^\s+|\s+$/g,"")};Object(u.x)(t,a).then(function(t){e.loading=!1,0===t.data.code?(e.rivateKeyList=t.data.data||[],e.total=t.data.totalCount):e.$message({type:"error",message:d.a.errCode[t.data.code].cn})}).catch(function(t){e.loading=!1,e.$message({type:"error",message:"系统错误！"})})},search:function(){this.getUserInfoData()},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.getUserInfoData()},handleCurrentChange:function(e){this.currentPage=e,this.getUserInfoData()},creatUserInfo:function(){},creatUserClose:function(){this.getUserInfoData()},bindUserClose:function(){this.getUserInfoData()},handleClose:function(){this.$refs.creatUser.modelClose()},modifyDescription:function(e){var t=this;this.$prompt("请输入用户描述","",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(a){var s=a.value;t.userDescriptionInfo(s,e)}).catch(function(){t.$message({type:"info",message:"取消"})})},userDescriptionInfo:function(e,t){var a=this,s={userId:t.userId,description:e};Object(u.w)(s).then(function(e){0==e.data.code?(a.getUserInfoData(),a.$message({type:"success",message:"修改用户成功"})):a.$message({type:"error",message:d.a.errCode[e.data.code].cn})}).catch(function(e){a.$message({type:"error",message:"修改失败！"})})},copyPubilcKey:function(e){var t=this;e?this.$copyText(e).then(function(e){t.$message({type:"success",showClose:!0,message:"复制成功",duration:2e3})}):this.$message({type:"fail",showClose:!0,message:"key为空，不复制。",duration:2e3})},userStatus:function(e){var t="";switch(e){case 1:t="正常";break;case 2:t="停用";break;default:t="正常"}return t},statusColor:function(e){var t="";switch(e){case 1:t="#58cb7d";break;case 2:t="#ed5454";break;default:t="#58cb7d"}return t}}},v=(a("rYv6"),Object(p.a)(f,s,[],!1,null,"117650a5",null));v.options.__file="src/views/rivateKeyManagement/rivateKeyManagement.vue";t.default=v.exports},rYv6:function(e,t,a){"use strict";var s=a("/0Jq");a.n(s).a}}]);